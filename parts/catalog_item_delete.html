{% extends "layout.html" %}
{% block body %}

<section>
    <h1>{{item.name}}</h1>
    <p>
        Description: {{item.description}}
    </p>
    <p>Are you sure you want to delete this item?</p>
    <button type="button" onclick="deleteItem()">Delete Item</button>
    <button type="button" onclick="cancelDelete()">Cancel</button>
    <div id="result"></div>
</section>
<script>

    function cancelDelete() {
        window.history.back();
    }

    function deleteItem() {
        $.ajax({
            type: 'DELETE',
            url: '/api/catalog/delete?category={{item.category}}&title={{item.name}}',
            processData: false,
            success: function (result) {
                // Handle or verify the server response if necessary.
                if (result) {
                    $('#result').html('Delete Successful!</br>' + result + '</br>Redirecting...')
                    setTimeout(function () {
                        window.location.href = "/catalog/{{item.category}}/Items";
                    }, 1000);

                } else {
                    $('#result').html('Failed to make a server-side call. Check your configuration and console.');
                }
            },
            error: function (response) {
                console.error(response);
                $('#result').html('Failed to make a server-side call. Check your configuration and console.');
            }

        });
    }
</script>
{% endblock %}